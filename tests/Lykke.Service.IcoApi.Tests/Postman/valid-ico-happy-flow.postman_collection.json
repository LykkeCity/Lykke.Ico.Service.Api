{
	"info": {
		"name": "Valid ICO - Happy Flow",
		"_postman_id": "d1ff175e-170c-634f-29d5-bd99800a1398",
		"description": "",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Remove Investor",
			"description": "",
			"item": [
				{
					"name": "/api/admin/investors/{email} - delete investor",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(204);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/all - delete all investor data",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(204);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/all",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"all"
							]
						},
						"description": ""
					},
					"response": []
				}
			]
		},
		{
			"name": "Check Rates Service",
			"description": "",
			"item": [
				{
					"name": "/api/admin/rates/latest - recheck rates availability",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Rates exists\", function() {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.expect(jsonData.averageRate !== null).to.be.true;",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/rates/latest",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"rates",
								"latest"
							]
						},
						"description": ""
					},
					"response": []
				}
			]
		},
		{
			"name": "Get Initial Data",
			"description": "",
			"item": [
				{
					"name": "/api/admin/campaign/info - remember campaign data",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Campaign data\", function() {",
									"    var jsonData = pm.response.json();",
									"",
									"    pm.environment.set(\"addressPoolCurrentSize\", (typeof jsonData.addressPoolCurrentSize === 'undefined') ? 0 : jsonData.addressPoolCurrentSize);",
									"    pm.environment.set(\"investorsRegistered\", (typeof jsonData.investorsRegistered === 'undefined') ? 0 : jsonData.investorsRegistered);",
									"    pm.environment.set(\"investorsConfirmed\", (typeof jsonData.investorsConfirmed === 'undefined') ? 0 : jsonData.investorsConfirmed);",
									"    pm.environment.set(\"investorsFilledIn\", (typeof jsonData.investorsFilledIn === 'undefined') ? 0 : jsonData.investorsFilledIn);",
									"    pm.environment.set(\"amountInvestedBtc\", (typeof jsonData.amountInvestedBtc === 'undefined') ? 0 : jsonData.amountInvestedBtc);",
									"    pm.environment.set(\"amountInvestedEth\", (typeof jsonData.amountInvestedEth === 'undefined') ? 0 : jsonData.amountInvestedEth);",
									"    pm.environment.set(\"amountInvestedFiat\", (typeof jsonData.amountInvestedFiat === 'undefined') ? 0 : jsonData.amountInvestedFiat);",
									"    pm.environment.set(\"amountInvestedToken\", (typeof jsonData.amountInvestedToken === 'undefined') ? 0 : jsonData.amountInvestedToken);",
									"    pm.environment.set(\"amountInvestedUsd\", (typeof jsonData.amountInvestedUsd === 'undefined') ? 0 : jsonData.amountInvestedUsd);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/campaign/info",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"campaign",
								"info"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/history - remember history",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Save Investor profile changes number\", function () {",
									"    var jsonData = pm.response.json();",
									"",
									"    pm.environment.set(\"investor-history-size\", (typeof jsonData.items === 'undefined') ? 0 : jsonData.items.count());",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/history",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"history"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/emails - remember emails number",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Emails sent number\", function () {",
									"    var jsonData = pm.response.json();",
									"",
									"    pm.environment.set(\"investor-emails-size\", (typeof jsonData.emails === 'undefined') ? 0 : jsonData.emails.count());",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/emails",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"emails"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/transactions - remember transactions",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Remember transactions sent number\", function () {",
									"    var jsonData = pm.response.json();",
									"",
									"    pm.environment.set(\"investor-transactions-size\", (typeof jsonData.transactions === 'undefined') ? 0 : jsonData.transactions.count());",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/transactions",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"transactions"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/pool/history - remember address pool",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Remember transactions sent number\", function () {",
									"    var jsonData = pm.response.json();",
									"",
									"    pm.environment.set(\"investor-address-pool-size\", (typeof jsonData.items === 'undefined') ? 0 : jsonData.items.count());",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/pool/history",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"pool",
								"history"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/eth/address/random - get token address",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Get token Address\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"token_address\", jsonData.address);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/eth/address/random",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"eth",
								"address",
								"random"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/eth/address/random - get eth refund address",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Get eth refund Address\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"refund_eth_address\", jsonData.address);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/eth/address/random",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"eth",
								"address",
								"random"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/btc/address/random - get btc refund address",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Get btc refund address\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set(\"refund_btc_address\", jsonData.address);    ",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/btc/address/random",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"btc",
								"address",
								"random"
							]
						},
						"description": ""
					},
					"response": []
				}
			]
		},
		{
			"name": "Register Investor",
			"description": "",
			"item": [
				{
					"name": "/api/investor/register - register investor",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Register investor\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.expect(jsonData.result).to.eql(\"confirmationEmailSent\");",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"{{email}}\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/investor/register",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"investor",
								"register"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/emails - wait confirmation email",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"var current = Number(jsonData.emails.count());",
									"var expected = Number(pm.environment.get(\"investor-emails-size\")) + 1;",
									"",
									"if(current == expected){",
									"    console.info(\"Email recieved\");",
									"    pm.environment.set(\"investor-emails-size\", current);",
									"} else {",
									"    console.info(\"Wait 10 secs\");",
									"    setTimeout(function(){}, 10000);",
									"    postman.setNextRequest(\"/api/admin/investors/{email}/emails - wait confirmation email\");",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/emails",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"emails"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/history - check investor history",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "d6ae53d1-84dc-419a-8c20-db772406d8c5",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"1 new record in profile history (add)\", function () {",
									"    var jsonData = pm.response.json();",
									"    var current = Number(jsonData.items.count());",
									"    var expected = Number(pm.environment.get(\"investor-history-size\")) + 1;",
									"    ",
									"    pm.expect(current).to.eql(expected);",
									"    pm.environment.set(\"investor-history-size\", current);    ",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/history",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"history"
							]
						},
						"description": "recheck investor changes history"
					},
					"response": []
				}
			]
		},
		{
			"name": "Confirm Investor",
			"description": "",
			"item": [
				{
					"name": "/api/admin/investors/{email} - get confirmation token",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"",
									"pm.test(\"Recheck and remember confirmation token\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.expect(jsonData.email).to.eql(pm.environment.get(\"email\"));",
									"",
									"    pm.environment.set(\"confirmation_token\", jsonData.confirmationToken);    ",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/investor/confirmation/{token} - confirm user",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Confirm user and recieve auth token\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.expect(jsonData.authToken).to.eql(pm.environment.get(\"confirmation_token\"));",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/investor/confirmation/{{confirmation_token}}",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"investor",
								"confirmation",
								"{{confirmation_token}}"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email} - recheck confirmation",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"",
									"pm.test(\"Recheck confirmed datetime value\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.expect(jsonData.confirmedUtc !== null).to.be.true;",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/history - check investor history",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "6aaf4a0f-56b2-46c5-b520-8d3e6364a0e5",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"1 new record in profile history (confirm)\", function () {",
									"    var jsonData = pm.response.json();",
									"    var current = Number(jsonData.items.count());",
									"    var expected = Number(pm.environment.get(\"investor-history-size\")) + 1;",
									"    ",
									"    pm.expect(current).to.eql(expected);",
									"    pm.environment.set(\"investor-history-size\", current);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/history",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"history"
							]
						},
						"description": "recheck investor changes history"
					},
					"response": []
				}
			]
		},
		{
			"name": "Update Addresses",
			"description": "",
			"item": [
				{
					"name": "/api/investor - update investor addresses",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "authToken",
								"value": "{{confirmation_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"tokenAddress\": \"{{token_address}}\",\r\n  \"refundEthAddress\": \"{{refund_eth_address}}\",\r\n  \"refundBtcAddress\": \"{{refund_btc_address}}\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/investor",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"investor"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/emails - wait summary email",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"var current = Number(jsonData.emails.count());",
									"var expected = Number(pm.environment.get(\"investor-emails-size\")) + 1;",
									"",
									"if(current == expected){",
									"    console.info(\"Email recieved\");",
									"    pm.environment.set(\"investor-emails-size\", current);",
									"} else {",
									"    console.info(\"Wait 10 secs\");",
									"    setTimeout(function(){}, 10000);",
									"    postman.setNextRequest(\"/api/admin/investors/{email}/emails - wait summary email\");",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/emails",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"emails"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/investor - check investor addresses changes",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"token address is valid\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.tokenAddress).to.eql(pm.environment.get(\"token_address\"));",
									"});",
									"",
									"pm.test(\"refund eth address is valid\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.refundEthAddress).to.eql(pm.environment.get(\"refund_eth_address\"));",
									"});",
									"",
									"pm.test(\"refund btc address is valid\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.refundBtcAddress).to.eql(pm.environment.get(\"refund_btc_address\"));",
									"});",
									"",
									"pm.test(\"pay-in eth address is not empty\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.payInEthAddress !== null).to.be.true;",
									"});",
									"",
									"pm.test(\"pay-in btc address is not empty\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.payInBtcAddress !== null).to.be.true;",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "authToken",
								"value": "{{confirmation_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/investor",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"investor"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/campaign/info - check campaign changes",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"addressPoolCurrentSize is descreased to 1\", function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.addressPoolCurrentSize)).to.eql(Number(pm.environment.get(\"addressPoolCurrentSize\")) - 1);",
									"});",
									"",
									"pm.test(\"investorsRegistered is increased to 1\", function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.investorsRegistered)).to.eql(Number(pm.environment.get(\"investorsRegistered\")) + 1);",
									"});",
									"",
									"pm.test(\"investorsConfirmed is increased to 1\", function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.investorsConfirmed)).to.eql(Number(pm.environment.get(\"investorsConfirmed\")) + 1);",
									"});",
									"",
									"pm.test(\"investorsFilledIn is increased to 1\", function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.investorsFilledIn)).to.eql(Number(pm.environment.get(\"investorsFilledIn\")) + 1);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/campaign/info",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"campaign",
								"info"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/pool/history - check address pool history",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Must have 1 new address pool history item\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.expect(Number(jsonData.items.count())).to.eql(Number(pm.environment.get(\"investor-address-pool-size\")) + 1);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/pool/history",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"pool",
								"history"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/history - check investor history",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "7f89f96b-bb48-45cc-b92b-7ea474a46875",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"1 new record in profile history (update addresses)\", function () {",
									"    var jsonData = pm.response.json();",
									"    var current = Number(jsonData.items.count());",
									"    var expected = Number(pm.environment.get(\"investor-history-size\")) + 1;",
									"    ",
									"    pm.expect(current).to.eql(expected);",
									"    pm.environment.set(\"investor-history-size\", current);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/history",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"history"
							]
						},
						"description": "recheck investor changes history"
					},
					"response": []
				}
			]
		},
		{
			"name": "Send BTC Transaction",
			"description": "",
			"item": [
				{
					"name": "/api/admin/investors/{email} - get pay-in address and amounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"",
									"pm.test(\"Get data\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.environment.set(\"payInBtcAddress\", jsonData.payInBtcAddress);",
									"    pm.environment.set(\"amountBtc\", jsonData.amountBtc);",
									"    pm.environment.set(\"amountUsd\", jsonData.amountUsd);",
									"    pm.environment.set(\"amountToken\", jsonData.amountToken);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/btc/send/tx - send bitcoin transaction to queue",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"{{email}}\",\r\n  \"amount\": 0.012\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/btc/send/tx",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"btc",
								"send",
								"tx"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/emails - wait btc transaction email",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"var current = Number(jsonData.emails.count());",
									"var expected = Number(pm.environment.get(\"investor-emails-size\")) + 2;",
									"",
									"if(current == expected){",
									"    console.info(\"2 emails recieved (1 transaction and 1 need more funds)\");",
									"    pm.environment.set(\"investor-emails-size\", current);",
									"} else {",
									"    console.info(\"Wait 10 secs\");",
									"    setTimeout(function(){}, 10000);",
									"    postman.setNextRequest(\"/api/admin/investors/{email}/emails - wait btc transaction email\");",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/emails",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"emails"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/campaign/info - check campaign amounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "d65f1e88-6835-4008-bbf2-5494e347daac",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"amountInvestedBtc is valid\", function() {",
									"    var jsonData = pm.response.json();",
									"    var current = Number(jsonData.amountInvestedBtc);",
									"    var expected = Number(pm.environment.get(\"amountInvestedBtc\")) + 0.012;",
									"    ",
									"    pm.expect(expected).to.eql(current);",
									"});",
									"",
									"pm.test(\"amountInvestedToken was increased\", function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountInvestedToken) > Number(pm.environment.get(\"amountInvestedToken\"))).to.be.true;",
									"});",
									"",
									"pm.test(\"amountInvestedUsd was increased\", function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountInvestedUsd) > Number(pm.environment.get(\"amountInvestedUsd\"))).to.be.true;",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/campaign/info",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"campaign",
								"info"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email} - check investor amounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"amountBtc is valid\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountBtc)).to.eql(Number(pm.environment.get(\"amountBtc\")) + 0.012);",
									"});",
									"",
									"pm.test(\"amountUsd was increased\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountUsd) > Number(pm.environment.get(\"amountUsd\"))).to.be.true;",
									"});",
									"",
									"pm.test(\"amountToken was increased\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountToken) > Number(pm.environment.get(\"amountToken\"))).to.be.true;",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/transactions - check transactions",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Must have 1 new transaction\", function () {",
									"    var jsonData = pm.response.json();",
									"    var current = Number(jsonData.transactions.count());",
									"    var expected = Number(pm.environment.get(\"investor-transactions-size\")) + 1;",
									"    ",
									"    pm.expect(current).to.eql(expected);",
									"    pm.environment.set(\"investor-transactions-size\", current);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/transactions",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"transactions"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/history - check investor history",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "b6069cdf-1213-4b19-b91e-c839587d17d2",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"1 new record in profile history (increment amounts)\", function () {",
									"    var jsonData = pm.response.json();",
									"    var current = Number(jsonData.items.count());",
									"    var expected = Number(pm.environment.get(\"investor-history-size\")) + 1;",
									"    ",
									"    pm.expect(current).to.eql(expected);",
									"    pm.environment.set(\"investor-history-size\", current);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/history",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"history"
							]
						},
						"description": "recheck investor changes history"
					},
					"response": []
				}
			]
		},
		{
			"name": "Send ETH Transaction",
			"description": "",
			"item": [
				{
					"name": "/api/admin/investors/{email} - get pay-in address and amounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"",
									"pm.test(\"Get data\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.environment.set(\"payInEthAddress\", jsonData.payInEthAddress);",
									"    pm.environment.set(\"amountEth\", jsonData.amountEth);",
									"    pm.environment.set(\"amountUsd\", jsonData.amountUsd);",
									"    pm.environment.set(\"amountToken\", jsonData.amountToken);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/eth/send/tx - send ether transaction to queue",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"{{email}}\",\r\n  \"amount\": 0.5\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/eth/send/tx",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"eth",
								"send",
								"tx"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/emails - wait eth transaction emails",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"var current = Number(jsonData.emails.count());",
									"var expected = Number(pm.environment.get(\"investor-emails-size\")) + 2;",
									"",
									"if(current == expected){",
									"    console.info(\"2 emails recieved (1 transaction and 1 need more funds)\");",
									"    pm.environment.set(\"investor-emails-size\", current);",
									"} else {",
									"    console.info(\"Wait 10 secs\");",
									"    setTimeout(function(){}, 10000);",
									"    postman.setNextRequest(\"/api/admin/investors/{email}/emails - wait eth transaction emails\");",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/emails",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"emails"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/campaign/info - check campaign amounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "62bd80d2-23e0-46d9-8aac-7177bc3e3e60",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"amountInvestedEth is valid\", function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountInvestedEth)).to.eql(Number(pm.environment.get(\"amountInvestedEth\")) + 0.5);",
									"});",
									"",
									"pm.test(\"amountInvestedToken was increased\", function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountInvestedToken) > Number(pm.environment.get(\"amountInvestedToken\"))).to.be.true;",
									"});",
									"",
									"pm.test(\"amountInvestedUsd was increased\", function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountInvestedUsd) > Number(pm.environment.get(\"amountInvestedUsd\"))).to.be.true;",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/campaign/info",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"campaign",
								"info"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email} - check investor amounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"amountEth is valid\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountEth)).to.eql(Number(pm.environment.get(\"amountEth\")) + 0.5);",
									"});",
									"",
									"pm.test(\"amountUsd was increased\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountUsd) > Number(pm.environment.get(\"amountUsd\"))).to.be.true;",
									"});",
									"",
									"pm.test(\"amountToken was increased\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountToken) > Number(pm.environment.get(\"amountToken\"))).to.be.true;",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/transactions - check transactions",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Must have 1 new transaction\", function () {",
									"    var jsonData = pm.response.json();",
									"    var current = Number(jsonData.transactions.count());",
									"    var expected = Number(pm.environment.get(\"investor-transactions-size\")) + 1;",
									"    ",
									"    pm.expect(current).to.eql(expected);",
									"    pm.environment.set(\"investor-transactions-size\", current);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/transactions",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"transactions"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/history - check investor history",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "be83069d-c7f1-4917-b038-3e32ced33024",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"1 new record in profile history (increment amounts)\", function () {",
									"    var jsonData = pm.response.json();",
									"    var current = Number(jsonData.items.count());",
									"    var expected = Number(pm.environment.get(\"investor-history-size\")) + 1;",
									"    ",
									"    pm.expect(current).to.eql(expected);",
									"    pm.environment.set(\"investor-history-size\", current);    ",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/history",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"history"
							]
						},
						"description": "recheck investor changes history"
					},
					"response": []
				}
			]
		},
		{
			"name": "Send Fiat Transaction",
			"description": "",
			"item": [
				{
					"name": "/api/admin/investors/{email} - get pay-in address and amounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Get data\", function () {",
									"    var jsonData = pm.response.json();",
									"    ",
									"    pm.environment.set(\"amountFiat\", jsonData.amountFiat);",
									"    pm.environment.set(\"amountUsd\", jsonData.amountUsd);",
									"    pm.environment.set(\"amountToken\", jsonData.amountToken);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/fiat/send/tx - send fiat transaction to queue",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"{{email}}\",\r\n  \"amount\": 300\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/fiat/send/tx",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"fiat",
								"send",
								"tx"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/emails - wait fiat transaction email",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"var current = Number(jsonData.emails.count());",
									"var expected = Number(pm.environment.get(\"investor-emails-size\")) + 2;",
									"",
									"if(current == expected){",
									"    console.info(\"2 emails recieved (1 transaction and 1 KYC request)\");",
									"    pm.environment.set(\"investor-emails-size\", current);",
									"} else {",
									"    console.info(\"Wait 10 secs\");",
									"    setTimeout(function(){}, 10000);",
									"    postman.setNextRequest(\"/api/admin/investors/{email}/emails - wait fiat transaction email\");",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/emails",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"emails"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/campaign/info - check campaign amounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "4bf95db4-574c-4215-8f50-3608351fe5e4",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"amountInvestedFiat is valid\", function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountInvestedFiat)).to.eql(Number(pm.environment.get(\"amountInvestedFiat\")) + (300 - 300*0.039));",
									"});",
									"",
									"pm.test(\"amountInvestedToken was increased\", function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountInvestedToken) > Number(pm.environment.get(\"amountInvestedToken\"))).to.be.true;",
									"});",
									"",
									"pm.test(\"amountInvestedUsd was increased\", function() {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountInvestedUsd) > Number(pm.environment.get(\"amountInvestedUsd\"))).to.be.true;",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/campaign/info",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"campaign",
								"info"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email} - recheck investor amounts",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "048c9496-0839-4355-801b-eed074a253a1",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"amountFiat was increased\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountFiat)).to.eql(Number(pm.environment.get(\"amountFiat\")) + (300 - 300*0.039));",
									"});",
									"",
									"pm.test(\"amountUsd was increased\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountUsd) > Number(pm.environment.get(\"amountUsd\"))).to.be.true;",
									"});",
									"",
									"pm.test(\"amountToken was increased\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(Number(jsonData.amountToken) > Number(pm.environment.get(\"amountToken\"))).to.be.true;",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/transactions - check transactions",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Must have 1 new transaction\", function () {",
									"    var jsonData = pm.response.json();",
									"    var current = Number(jsonData.transactions.count());",
									"    var expected = Number(pm.environment.get(\"investor-transactions-size\")) + 1;",
									"    ",
									"    pm.expect(current).to.eql(expected);",
									"    pm.environment.set(\"investor-transactions-size\", current);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/transactions",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"transactions"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "/api/admin/investors/{email}/history - check investor history",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "556542ba-7457-4219-a5c9-006878237e8c",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"2 new records in profile history (increment amounts + kyc request)\", function () {",
									"    var jsonData = pm.response.json();",
									"    var current = Number(jsonData.items.count());",
									"    var expected = Number(pm.environment.get(\"investor-history-size\")) + 2;",
									"    ",
									"    pm.expect(current).to.eql(expected);",
									"    pm.environment.set(\"investor-history-size\", current);    ",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "adminAuthToken",
								"value": "{{admin_auth_token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"email\": \"andrey.krivoshapov@lykke.com\"\r\n}"
						},
						"url": {
							"raw": "{{domain}}/api/admin/investors/{{email}}/history",
							"host": [
								"{{domain}}"
							],
							"path": [
								"api",
								"admin",
								"investors",
								"{{email}}",
								"history"
							]
						},
						"description": "recheck investor changes history"
					},
					"response": []
				}
			]
		}
	]
}